<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>iPod Web Player</title>
<style>
body {
    background-image: url('back.png');
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    font-family: sans-serif;
}
.ipod {
    width: 240px;
    height: 400px;
    background: radial-gradient(circle, #ffffff 0%, #888888 100%);
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px;
}
.screen {
    width: 100%;
    height: 60%;
    background: #dfe0dc9c;
    color: #3e3e3e;
    box-shadow: inset 0 0 10px #000000e6;
    border-radius: 5px;
    font-size: 11px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}
.topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    font-size: 10px;
    border-bottom: 1px solid #3e3e3e;
    position: relative;
}
.topcenter {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    font-weight: bold;
}
#display { flex: 1; overflow: hidden; position: relative; }
.screen ul {
    list-style: none;
    padding: 5px;
    margin: 0;
}
.screen li {
    display: flex;
    justify-content: space-between;
    padding: 5px 8px;
    width: 100%;
    border-radius: 3px;
    box-sizing: border-box;
    cursor: pointer;
}
.screen li.active {
    background: rgb(163, 186, 193);
    color: #111;
}
.wheel {
    width: 200px;
    height: 200px;
    background: #ddd;
    border-radius: 50%;
    position: relative;
    margin-top: 10px;
}
.button {
    position: absolute;
    text-align: center;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
}
.top { top: 10px; left: 50%; transform: translateX(-50%); }
.bottom { bottom: 10px; left: 50%; transform: translateX(-50%); }
.left { left: 10px; top: 50%; transform: translateY(-50%); }
.right { right: 10px; top: 50%; transform: translateY(-50%); }
.center {
    width: 60px;
    height: 60px;
    background: #bbb;
    border-radius: 50%;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
}
.play-container {
    display: flex;
    gap: 5px;
}
.play-container img { width: 80px; height: 80px; object-fit: cover; }
.play-container .info { flex: 1; font-size: 10px; }
</style>
</head>
<body>
<div class="ipod">
    <div class="screen">
        <div class="topbar">
            <span id="clock"></span>
            <span class="topcenter">iPod</span>
            <span class="battery">ğŸ”‹</span>
        </div>
        <div id="display"></div>
    </div>
    <div class="wheel">
        <div class="button top" id="btn-menu">MENU</div>
        <div class="button left" id="btn-left">|â—€â—€</div>
        <div class="button right" id="btn-right">â–¶â–¶|</div>
        <div class="button bottom" id="btn-play">â–¶||</div>
        <div class="button center" id="btn-center"></div>
    </div>
</div>

<!-- YouTube Player (ìˆ¨ê¹€) -->
<div id="youtube-player"></div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const display = document.getElementById("display");
const clockEl = document.getElementById("clock");

// ì‹œê³„ ê°±ì‹ 
function updateClock() {
    const d = new Date();
    const h = d.getHours().toString().padStart(2,'0');
    const m = d.getMinutes().toString().padStart(2,'0');
    clockEl.textContent = `${h}:${m}`;
}
setInterval(updateClock, 1000);
updateClock();

// ê³¡ ë°ì´í„°
const songs = [
    { videoId:"ScMzIvxBSi4", image:"https://placekitten.com/200/200", info:"ê³¡A - ê°€ìˆ˜A", month:"1ì›”", genre:"band" },
    { videoId:"ysz5S6PUM-U", image:"https://placebear.com/200/200", info:"ê³¡B - ê°€ìˆ˜B", month:"2ì›”", genre:"k-pop" },
    { videoId:"M7lc1UVf-VE", image:"https://placekitten.com/201/201", info:"ê³¡C - ê°€ìˆ˜C", month:"1ì›”", genre:"solo" },
    { videoId:"E7wJTI-1dvQ", image:"https://placebear.com/201/201", info:"ê³¡D - ê°€ìˆ˜D", month:"3ì›”", genre:"balad" }
];

// User Info
const userInfo = {
    "User Name":"seoeun",
    "Created On":"2025-09-16",
    "Last Login":"2025-09-16",
    "Email":"tjdmsj@gmail.com",
};

// ë©”ë‰´ êµ¬ì¡°
const menuTree = {
    root:["Playlist","Setting"],
    Playlist:["Month","Genre","Feel","Shuffle Songs"],
    Month:["1ì›”","2ì›”","3ì›”","4ì›”","5ì›”","6ì›”","7ì›”","8ì›”","9ì›”","10ì›”","11ì›”","12ì›”"],
    Genre:["band","solo","balad","k-pop","pop","britpop","synthesiser","shoegaze","soundtrack"],
    Feel:["Happy","Sad","Calm"] // ì˜ˆì‹œ Feel
};

let state = { path:["root"], index:0 };
let currentList = [], currentSongIndex = 0;
let player;

// renderMenu í•¨ìˆ˜ (Setting ì²˜ë¦¬ í¬í•¨)
function renderMenu() {
    const current = state.path[state.path.length-1];

    // Setting ì„ íƒ ì‹œ userInfo í‘œì‹œ
    if(current === "Setting") {
        display.innerHTML = "<ul>" +
            Object.entries(userInfo).map(([key,val]) =>
                `<li style="justify-content: space-between;"><span>${key}</span><span>${val}</span></li>`
            ).join("") + "</ul>";
        return;
    }

    const items = menuTree[current];

    // Month ë©”ë‰´ì¼ ê²½ìš° í˜ì´ì§• ì²˜ë¦¬
    let startIndex = 0, endIndex = items.length;
    if(current === "Month") {
        const pageSize = 6; // í•œ í™”ë©´ì— 6ê°œ
        // í˜„ì¬ ì„ íƒëœ ì¸ë±ìŠ¤ì— ë”°ë¼ í˜ì´ì§€ ê²°ì •
        let page = Math.floor(state.index / pageSize);
        startIndex = page * pageSize;
        endIndex = startIndex + pageSize;
        if(endIndex > items.length) endIndex = items.length;
    }

    display.innerHTML = "<ul>" +
        items.slice(startIndex,endIndex).map((m,i) => {
            // í™”ë©´ì— ë³´ì—¬ì§€ëŠ” index ê³„ì‚°
            const actualIndex = startIndex + i;
            return `<li class="${actualIndex === state.index ? "active" : ""}">
                <span>${m}</span><span>â–¶</span></li>`;
        }).join("") +
        "</ul>";
}

// í˜„ì¬ ì„ íƒ í•­ëª©
function currentItem(){ 
    const cur = state.path[state.path.length-1];
    if(cur in menuTree) return menuTree[cur][state.index];
    return null;
}

// ì¬ìƒ í™”ë©´
function playSong(song){
    player.loadVideoById(song.videoId);
    display.innerHTML = `
        <div class="play-container">
            <img src="${song.image}">
            <div class="info">${song.info}</div>
        </div>
    `;
}

// YouTube API
function onYouTubeIframeAPIReady() {
    player = new YT.Player("youtube-player",{height:"0",width:"0",videoId:"",events:{onStateChange:onPlayerStateChange}});
}
function onPlayerStateChange(e){
    if(e.data===YT.PlayerState.ENDED){
        currentSongIndex++;
        if(currentSongIndex<currentList.length){
            playSong(currentList[currentSongIndex]);
        } else {
            state.path = ["root"];
            state.index = 0;
            renderMenu();
        }
    }
}

// ë²„íŠ¼ ì´ë²¤íŠ¸
document.getElementById("btn-center").onclick = ()=>{
    const item = currentItem();
    const cur = state.path[state.path.length-1];

    if(cur in menuTree){
        state.path.push(item);
        state.index=0;

        if(item==="Shuffle Songs"){
            currentList = [...songs].sort(()=>Math.random()-0.5);
            currentSongIndex=0;
            playSong(currentList[currentSongIndex]);
        } else if(item==="Month" || menuTree[item]) {
            renderMenu();
        } else if(item==="Setting") {
            renderMenu();
        } else {
            if(state.path[state.path.length-2]==="Month"){
                currentList = songs.filter(s=>s.month===item);
            } else if(state.path[state.path.length-2]==="Genre"){
                currentList = songs.filter(s=>s.genre===item);
            }
            currentSongIndex=0;
            playSong(currentList[currentSongIndex]);
        }
    } else if(currentList.length>0){
        player.playVideo();
    }
};

document.getElementById("btn-menu").onclick = ()=>{
    if(state.path.length>1){
        state.path.pop();
        state.index=0;
        renderMenu();
    }
};

document.getElementById("btn-right").onclick = ()=>{
    const cur = state.path[state.path.length-1];
    if(cur in menuTree){
        state.index++;
        if(state.index >= menuTree[cur].length){
            state.index = 0; // ë§ˆì§€ë§‰ ë„˜ì–´ê°€ë©´ ì´ˆê¸°í™”
        }
        renderMenu();
    } else if(currentList.length>0){
        currentSongIndex++;
        if(currentSongIndex>=currentList.length) currentSongIndex=0;
        playSong(currentList[currentSongIndex]);
    }
};

document.getElementById("btn-left").onclick = ()=>{
    const cur = state.path[state.path.length-1];
    if(cur in menuTree){
        state.index--;
        if(state.index < 0){
            state.index = menuTree[cur].length-1; // ì²« í•­ëª© ë„˜ì–´ê°€ë©´ ë§ˆì§€ë§‰ìœ¼ë¡œ
        }
        renderMenu();
    } else if(currentList.length>0){
        currentSongIndex--;
        if(currentSongIndex<0) currentSongIndex=currentList.length-1;
        playSong(currentList[currentSongIndex]);
    }
};


document.getElementById("btn-play").onclick = ()=>{
    if(currentList.length>0) player.playVideo();
};

// ì´ˆê¸°í™”
renderMenu();
</script>
</body>
</html>
